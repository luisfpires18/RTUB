@namespace RTUB.Shared

@*
    FormTextArea Component
    Modern textarea field with optional icon, following DetailsModal and Profile design patterns
*@

<div class="form-group @CssClass">
    @if (!string.IsNullOrEmpty(Label))
    {
        <label class="form-label fw-semibold @LabelCssClass">
            @if (!string.IsNullOrEmpty(Icon))
            {
                <i class="bi bi-@Icon text-primary me-2"></i>
            }
            @Label
            @if (Required)
            {
                <span class="text-danger ms-1">*</span>
            }
        </label>
    }
    <textarea class="form-control @InputCssClass" 
              rows="@Rows"
              value="@Value" 
              @onchange="OnValueChanged"
              placeholder="@Placeholder"
              disabled="@Disabled"
              readonly="@ReadOnly"></textarea>
    @if (!string.IsNullOrEmpty(HelpText))
    {
        <small class="form-text text-muted mt-1 d-block">@HelpText</small>
    }
</div>

@code {
    /// <summary>
    /// Label text for the textarea field
    /// </summary>
    [Parameter]
    public string Label { get; set; } = string.Empty;

    /// <summary>
    /// Bootstrap icon class name (without "bi-" prefix, e.g., "text-paragraph")
    /// </summary>
    [Parameter]
    public string? Icon { get; set; }

    /// <summary>
    /// Current value of the textarea
    /// </summary>
    [Parameter]
    public string? Value { get; set; }

    /// <summary>
    /// Event callback when value changes
    /// </summary>
    [Parameter]
    public EventCallback<string?> ValueChanged { get; set; }

    /// <summary>
    /// Placeholder text for the textarea
    /// </summary>
    [Parameter]
    public string? Placeholder { get; set; }

    /// <summary>
    /// Number of rows for the textarea
    /// </summary>
    [Parameter]
    public int Rows { get; set; } = 3;

    /// <summary>
    /// Whether the field is required
    /// </summary>
    [Parameter]
    public bool Required { get; set; }

    /// <summary>
    /// Whether the field is disabled
    /// </summary>
    [Parameter]
    public bool Disabled { get; set; }

    /// <summary>
    /// Whether the field is read-only
    /// </summary>
    [Parameter]
    public bool ReadOnly { get; set; }

    /// <summary>
    /// Help text displayed below the textarea
    /// </summary>
    [Parameter]
    public string? HelpText { get; set; }

    /// <summary>
    /// Additional CSS classes for the form group
    /// </summary>
    [Parameter]
    public string CssClass { get; set; } = string.Empty;

    /// <summary>
    /// Additional CSS classes for the label
    /// </summary>
    [Parameter]
    public string LabelCssClass { get; set; } = string.Empty;

    /// <summary>
    /// Additional CSS classes for the textarea
    /// </summary>
    [Parameter]
    public string InputCssClass { get; set; } = string.Empty;

    private async Task OnValueChanged(ChangeEventArgs e)
    {
        Value = e.Value?.ToString();
        await ValueChanged.InvokeAsync(Value);
    }
}
